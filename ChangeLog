2003-09-10  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* Makefile.am: only build the gl/ directory if required

	* configure.ac: simplify handling of --enable-demos. Add support
	for --disable-gl option; gl support is only compiled in if
	GL/glx.h is found

2003-09-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* config/xformsinclude.m4 (XFORMS_CHECK_LIB_JPEG): no need to link
	against the X11 libs...

	* configure.ac: remove lots of checks for headers and functions.
	We only keep the ones that were already tested for in the old
	source (although we do not know whether they are still useful).

	* lib/asyn_io.c: use HAVE_SYS_SELECT_H

2003-09-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* Makefile.am: only build demos/ directory if required

	* configure.ac: add --enable-demos option

2003-09-09  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/forms.c (fl_keyboard): pass it the event to allow it to
	distinguish between KeyPress and KeyRelease events.
	(dispatch_key): new function, factored out of do_keyboard.
	(do_keyboard): Handles KeyRelease events correctly. The KeyPress keysym
	is stored and then dispatched on KeyRelease also, since
	XmbLookupString is undefined on a KeyRelease event.

2003-09-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lib/version.c (fl_print_version): remove workaround for XENIX

	* lib/local.h: remove NO_SOCK (who wants to support old SCO anyway?)

2003-07-31  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lib/local.h (FL_SIGRET):

	* lib/signal.c (default_signal_handler): use RETSIGTYPE instead of
	FL_SIG_RET

	* lib/errmsg.c (fl_get_syserror_msg): use HAVE_STRERROR

	* lib/sysdep.c (fl_msleep): use HAVE_USLEEP

	* lib/local.h: remove variables DONT_HAVE_USLEEP,
	DONT_HAVE_STRERROR, NO_CONST (handled by AC_C_CONST),
	FL_SIGRET_IS_VOID, FL_SIGRET

	* configure.ac: check for usleep too

2003-05-23  Angus Leeming  <angus.leeming@btopenworld.com>

	* image/rgb_db.c: follow Rouben Rostamian's advice and remove all the
	helper functions that were used to ascertain the name of the RGB color
	before he rewrote fl_lookup_RGBcolor.

	* flimage.h: add a comment to the declaration of fl_init_RGBdatabase
	that is does nothing and is retained for compatibility only.

2003-05-23  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/include/Basic.h: remove declarations of functions
	fl_init_RGBdatabase and fl_lookup_RGBcolor as they are part of
	libflimage, not libforms.

2003-05-30  Angus Leeming  <angus.leeming@btopenworld.com>

	* Changes: renamed as NEWS.
	* COPYING: renamed as COPYING.LIB.
	* 00README: renamed as README.

2003-05-22  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lib/include/Makefile.am: make sure that forms.h is not distributed

2003-05-21  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* configure.ac: do not set VERSION explicitely, this is done in
	XFORMS_SET_VERSION.

	* config/xformsinclude.m4 (XFORMS_SET_VERSION): simplify a tiny bit

2003-05-22  Rouben Rostamian  <rostamian@umbc.edu>

	* image/rgb_db.c (fl_lookup_RGBcolor): this function fell off the
	dist at 1.0pre3. Now it is back again with a shiny new, more efficient
	implementation.

2003-05-05  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lib/include/Makefile.am (forms.h): create forms.h using the
	target stamp-forms, so that it remains untouched when AAA.h is
	regenerated but did not change.

	* lib/include/AAA.h.in: new file. This is the template from which
	AAA.h is generated

	* lib/include/.cvsignore: add AAA.h

	* configure.ac: call XFORMS_SET_VERSION; generate AAA.h from AAA.h.in

	* config/xformsinclude.m4 (XFORMS_SET_VERSION): new macro, which
	sets the VERSION string for xforms
	(XFORMS_CHECK_VERSION): simplify a bit

2003-04-24  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* image/image_fits.c (Bad_bpp): use abs() and not fabs(), since
	bpp is an int

2003-04-24  Angus Leeming  <angus.leeming@btopenworld.com>

	Migrate from imake to autoconf/automake.

	* Imakefile:
	* Imakefile.os2:
	* demos/Imakefile:
	* demos/Imakefile.os2:
	* fd2ps/Imakefile:
	* fd2ps/Imakefile.os2:
	* fdesign/Imakefile:
	* fdesign/Imakefile.os2:
	* fdesign/Imakefile.xxx:
	* gl/Imakefile:
	* image/Imakefile:
	* lib/Imakefile:
	* lib/Imakefile.os2:
	* lib/OS2/Imakefile.os2:
	* lib/include/Imakefile: removed.

	* autogen.sh:
	* configure.ac:
	* config/.cvsignore:
	* config/common.am:
	* config/config.guess:
	* config/config.sub:
	* config/cygwin.m4:
	* config/depcomp:
	* config/libtool.m4:
	* config/ltmain.sh:
	* config/xformsinclude.m4: Here be magic ;-)

	* Makefile.am:
	* config/Makefile.am:
	* demos/Makefile.am:
	* demos/fd/Makefile.am:
	* fd2ps/Makefile.am:
	* fd2ps/test/Makefile.am:
	* fdesign/Makefile.am:
	* fdesign/fd/Makefile.am:
	* fdesign/fd4test/Makefile.am:
	* fdesign/notes/Makefile.am:
	* fdesign/spec/Makefile.am:
	* fdesign/xpm/Makefile.am:
	* gl/Makefile.am:
	* image/Makefile.am:
	* lib/Makefile.am:
	* lib/OS2/Makefile.am:
	* lib/bitmaps/Makefile.am:
	* lib/fd/Makefile.am:
	* lib/include/Makefile.am:
	* lib/private/Makefile.am: added.

	* xforms.spec.in: the RPM spec file.

	* lib/local.h: make use of the HAVE_STRCASECMP preprocessor variable.

	* lib/pixmap.c: use XPM_H_LOCATION instead of pre-processor stuff.

	* demos/demotest.c: define the callback.

	* fd2ps/sys.c: use preprocessor variable HAVE_STRCASECMP rather than
	NO_STRCASECMP.

	* fd2ps/sys.h: now redundant, so remove it.

	* fd2ps/fd2ps.h:
	* fd2ps/sys.c: remove #include "sys.h"

	* gl/canvas.h:
	* gl/glcanvas.h: make use of HAVE_GL_GLX_H preprocessor variable.

2003-04-24  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/tabfolder.c (handle): ensure that we have an active folder
	before trying to manipulate its contents.

2003-04-24  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/include/Imakefile: do not copy the generated forms.h to ../.
	* lib/Imakefile: remove the targets to install forms.h.

	* pretty well all .c files: change #include "forms.h" to
	#include "include/forms.h".

2003-04-22  Angus Leeming  <angus.leeming@btopenworld.com>

	* fd2ps/sys.h: remove #define NO_STRDUP and FL_SIGRET as they aren't
	used.

2003-04-22  Angus Leeming  <angus.leeming@btopenworld.com>

	* */*.c: ensure that config.h is #included if the HAVE_CONFIG_H
	preprocessor variable is set.

2003-04-22  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/include/zzz.h: remove the #include "flinternal.h" line whose
	inclusion depends on the MAKING_FORMS preprocessor variable.

	* lib/forms.h:
        * lib/include/forms.h: regenerated.

2003-04-20  Angus Leeming  <angus.leeming@btopenworld.com>

	* demos/wwwl.c: #include "private/flsnprintf.h".

2003-04-20  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/private/flsnprintf.h: use #defines to prevent needless
	fl_snprintf bloat.
	* lib/flsnprintf.c: prepend portable_v?snprintf with "fl_" to prevent
	name clashes with other software. Make these functions globally
	accessible.
	Importantly, #if 0...#endif a block that prevents the code from
	linking correctly on the DEC.

2003-04-20  Angus Leeming  <angus.leeming@btopenworld.com>

	* image/image.c:
	* lib/errmsg.c: no need to check for fl_vsnprintf anymore.

2003-04-20  Angus Leeming  <angus.leeming@btopenworld.com>

	* demos/Imakefile:
	* fd2ps/Imakefile:
	* fdesign/Imakefile:
	* gl/Imakefile:
	* image/Imakefile:
	* lib/Imakefile: pass the expected -DHAVE_SNPRINTF options to the
	compiler.

2003-04-17  Angus Leeming  <angus.leeming@btopenworld.com>

	Make fl_snprintf private.

	* lib/include/flsnprintf.h: moved to lib/private/flsnprintf.h.
	* lib/include/Imakefile: remove flsnprintf.h.

	* lib/forms.h:
	* lib/include/forms.h: regenerated.

	* fdesign/fd_attribs.c:
	* image/image.c:
	* image/image_io_filter.c:
	* image/image_postscript.c:
	* lib/choice.c:
	* lib/cmd_br.c:
	* lib/events.c:
	* lib/flresource.c:
	* lib/fselect.c:
	* lib/goodie_alert.c:
	* lib/goodie_choice.c:
	* lib/goodie_msg.c:
	* lib/goodie_salert.c:
	* lib/version.c:
	* lib/xpopup.c: add #include "private/flsnprintf.h".

2003-04-17  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* lib/Imakefile (EXTRA_INCLUDES): add $(XPMINC)

2003-04-17  Angus Leeming  <angus.leeming@btopenworld.com>

	* demos/Imakefile:
	* fd2ps/Imakefile:
	* fdesign/Imakefile:
	* gl/Imakefile:
	* image/Imakefile:
	* lib/Imakefile: don't pass -Iprivate to the complier.

	* fdesign/fd_super.c:
	* fdesign/sp_browser.c:
	* fdesign/sp_choice.c:
	* fdesign/sp_counter.c:
	* fdesign/sp_dial.c:
	* fdesign/sp_menu.c:
	* fdesign/sp_positioner.c:
	* fdesign/sp_xyplot.c:
	* image/image_postscript.c:
	* image/postscript.c:
	* image/ps_core.c:
	* image/ps_draw.c:
	* image/ps_text.c:
	* lib/browser.c:
	* lib/canvas.c:
	* lib/choice.c:
	* lib/counter.c:
	* lib/dial.c:
	* lib/flinternal.h:
	* lib/formbrowser.c:
	* lib/menu.c:
	* lib/objects.c:
	* lib/positioner.c:
	* lib/scrollbar.c:
	* lib/sldraw.c:
	* lib/slider.c:
	* lib/textbox.c:
	* lib/thumbwheel.c:
	* lib/valuator.c:
	* lib/xyplot.c: associated changes to the #include directives.

2003-04-17  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/xforms.5: renamed as xforms.man. This probably breaks the
	installation, but that is all slated for change anyway.

2003-04-17  Angus Leeming  <angus.leeming@btopenworld.com>

	* demos/Imakefile: do not -Ifd when compiling.

	* demos/Imakefile:
	* demos/buttonall.c:
	* demos/demotest.c:
	* demos/dirlist.c:
	* demos/folder.c:
	* demos/formbrowser.c:
	* demos/ibrowser.c:
	* demos/inputall.c:
	* demos/itest.c:
	* demos/scrollbar.c:
	* demos/thumbwheel.c: associated changes.

	* demos/.cvsignore: add all the generated executables.

2003-04-17  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/include/canvas.h: cruft removal. Don't mention glcanvas.h
	here in case the user does not want GL support.

	* lib/include/forms.h
	* lib/forms.h: regenerated.

	* gl/glcanvas.c: include glcanvas.h as this is no longer in forms.h

2003-04-16  Angus Leeming  <angus.leeming@btopenworld.com>

	Remove the SNP directory and replace it with a single file,
	flsnprintf.c. Invoke snprintf through a wrapper fl_snprintf.

	* Imakefile: remove SUBDIR snp.

	* lib/flsnprintf.c, lib/include/flsnprintf.h: new files.

	* lib/include/Imakefile: add flsnprintf.h to the files used to
	generated forms.h.

	* lib/forms.h
	* lib/include/forms.h: regenerated.

	* lib/Imakefile: add flsnprintf.c.
	Pass -DHAVE_SNPRINTF as a compiler option.

	* lib/local.h: remove HAVE_SNPRINTF stuff.

	* demos/Imakefile:
	* fd2ps/Imakefile:
	* fdesign/Imakefile:
	* gl/Imakefile:
	* image/Imakefile:
	pass -DHAVE_SNPRINTF as a compiler option. Remove other SNP stuff.

	* demos/wwwl.c:
	* fdesign/fd_attribs.c:
	* image/image.c:
	* image/image_io_filter.c:
	* image/image_postscript.c:
	* lib/choice.c:
	* lib/cmd_br.c:
	* lib/errmsg.c:
	* lib/events.c:
	* lib/flresource.c:
	* lib/fselect.c:
	* lib/goodie_alert.c:
	* lib/goodie_choice.c:
	* lib/goodie_msg.c:
	* lib/goodie_salert.c:
	* lib/version.c:
	* lib/xpopup.c:
	s/\(v*snprintf\)/fl_\1/

	* snp/*: all files removed.

2003-04-15  Angus Leeming  <angus.leeming@btopenworld.com>

	* lots of files: reduce the amount of magic includes of header files
	and therefore include flinternal.h explicitly much more.

2003-04-15  Angus Leeming  <angus.leeming@btopenworld.com>

	* .cvsignore:
	* demos/.cvsignore:
	* fd2ps/.cvsignore:
	* fdesign/.cvsignore:
	* gl/.cvsignore:
	* image/.cvsignore:
	* libs/.cvsignore:
	* libs/include/.cvsignore: prepare the way for autoconf/automake.

2003-04-10  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/include/Basic.h: add FL_RESIZED to the FL_EVENTS enum.
	* lib/include/AAA.h: up FL_FIXLEVEL to 2 to reflect this.

	* lib/forms.h:
	* lib/include/forms.h: regenerated.

	* lib/forms.c (scale_form): pass event FL_RESIZED to the object handler
	if the object size is changed.

	* lib/tabfolder.c (handle): handle the FL_RESIZED event to ensure
	that the currently active folder is resized.

2003-04-10  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/version.c (fl_print_version, fl_library_version): use
	FL_VERSION, FL_REVISION rather than RCS stuff.

2003-04-10  Angus Leeming  <angus.leeming@btopenworld.com>

	* most files: Remove all the RCS strings from the header files
	and about half of 'em from the .c files.

2003-04-10  John Levon <moz@compsoc.man.ac.uk>

	* lib/pixmap.c (init_xpm_attributes): "fix" XPixmaps containing
	colour "opaque".

2003-04-09  Angus Leeming  <angus.leeming@btopenworld.com>

	* demos/.cvsignore:
	* snp/.cvsignore: Ignore Makefile*

2003-04-09  Angus Leeming  <angus.leeming@btopenworld.com>

	Move tabfolder-specific code out of forms.c and allow individual
	FL_OBJECTs to respond to such events. Means that the library
	becomes extensible to new, user-defined widgets once again.

	* lib/include/Basic.h: add FL_MOVEORIGIN to the FL_EVENTS enum.

	* lib/forms.h:
	* lib/include/forms.h: regenerated automatically.

	* lib/forms.c (fl_handle_form): no longer a static function.
	Dispatch FL_MOVEORIGIN events to the form's constituent objects.
	(fl_get_tabfolder_origin): removed. Functionality moved into
	tabfolder.c.
	(do_interaction_step): no longer call fl_get_tabfolder_origin. Instead,
	dispatch a call to fl_handle_form(form, FL_MOVEORIGIN, ...).

	* lib/tabfolder.c (handle): add FL_MOVEORIGIN to the event switch.
	Update the x,y absolute coords of the active_folder and dispatch
	a call to fl_handle_form(active_folder, FL_MOVEORIGIN, ...) to
	ensure that the x,y absolute coords of nested tabfolders are also
	updated.

2003-04-09  Jean-Marc Lasgouttes  <lasgouttes@lyx.org>

	* image/Imakefile (EXTRA_INCLUDES): change the order of includes,
	to avoid that an older installed forms.h is used instead of the
	fresh one

2003-04-09  Angus Leeming  <angus.leeming@btopenworld.com>

	* lib/objects.c (hide_tooltip): renamed as checked_hide_tooltip.
	(unconditional_hide_tooltip): new static helper function,
	invoked within fl_handle_it on FL_KEYPRESS and FL_PUSH events.

	* lib/include/AAA.h: up-ed FL_FIXLEVEL to 1 to reflect the changes
	made above.
	* lib/forms.h: regenerated to reflect changed FL_FIXLEVEL.

	* version.c (version): update to reflect this also.

2003-04-08  Angus Leeming  <angus.leeming@btopenworld.com>

	Enable tooltips to be shown correctly in "composite" widgets
	such as the browser.

	* lib/objects.c (get_parent): new static helper function. Given an
	FL_OBJECT*, returns its parent FL_OBJECT.
	(tooltip_handler): rewritten to show the tooltip that is stored
	by the parent FL_OBJECT.
	(hide_tooltip): new static helper function: on leaving an FL_OBJECT,
	only hide the tooltip if we have also left the bounds of the parent
	FL_OBJECT.
	(fl_handle_it): make use of these new functions to show and hide
	tooltips.

2003-04-08  Angus Leeming  <angus.leeming@btopenworld.com>

	* image/image_rotate.c (flimage_rotate): enable the rotation of
	grayscale images by 90degree multiples and more generally prevent
	other unsupported image types from crashing xforms.

	* lib/flresource.c (fl_initialize): clean-up properly if we fail to
	create input contexts or methods.

	* lib/textbox.c (handle_textbox):
	* lib/thumbwheel.c (handle):
	* lib/util.c (flevent): FL_KEYBOARD has been replaced by FL_KEYPRESS.
	The former is retained for compatability, but the latter should be
	used internally.
