Summary:         XForms library
Name:            @PACKAGE@
Version:         @VERSION@
Release:         1
Source0:         http://savannah.nongnu.org/download/xforms/%{name}-%{version}.tar.gz
License:         LGPL
Group:           System/Libraries
BuildRequires:   xpm
BuildRequires:   xpm-devel
BuildRequires:   libjpeg
BuildRequires:   libjpeg-devel
Requires(post):  info
Requires(preun): info
BuildRoot:       %{_tmppath}/%{name}-buildroot
Prefix:          %{_prefix}
URL:             http://xforms-toolkit.org/

%description
XForms is a GUI toolkit based on Xlib for X Window Systems. It
features a rich set of objects, such as buttons, sliders, and menus
etc. integrated into an easy and efficient object/event callback
execution model that allows fast and easy construction of
X-applications. In addition, the library is extensible and new objects
can easily be created and added to the library.


# Beside the normal package create a "development" package, containing
# the header files for the three libraries.  This is an architecture-
# independent package.

%package devel
Summary:       XForms development header files
Group:         System/Libraries
BuildArch:     noarch

%description devel
XForms header files for development.


# Also create a documentation package with the full documenttaion in
# info, HTML and PDF format. This is an architecture-independent
# package.

%package doc
Summary:       XForms documentation
Group:         System/Libraries
BuildArch:     noarch

%description doc
XForms info, HTML and PDF documentation


# Unpack the tar-ball

%prep
%setup -q -n %{name}-%{version}


# Build everything

%build
./configure --prefix=%{_prefix} \
            --mandir=%{_mandir} \
            --bindir=%{_bindir} \
            --libdir=%{_libdir} \
            --infodir=%{_infodir} \
            --htmldir=%{_docdir}/%{name}/html \
            --pdfdir=%{_docdir}/%{name} \
            --enable-docs \
            --without-warnings \
            --disable-debug \
            --enable-optimization=-O2
make


# Install everything in %{buildroot}, afterwards delete the dir file
# from %{_infodir}, it's not to be distributed and gets created (or
# updated) during installation on the target machine

%install
rm -rf %{buildroot}
install -d -m 755 %{buildroot}
make DESTDIR=%{buildroot} install
rm -f %{buildroot}%{_infodir}/dir


%clean
rm -rf %{buildroot}


# Set up list of files in the binary package

%files
%{_libdir}
%{_bindir}
%{_mandir}
%defattr(-,root,root)
%doc COPYING.LIB Copyright ChangeLog INSTALL INSTALL.git README


# Set up list of files going into the development package

%files devel
%{_includedir}
%defattr(-,root,root)


# Set up list of files distributed with the documentation package

%files doc
%{_docdir}/%{name}
%{_infodir}
%defattr(-,root,root)


# Run ldconfig after install on the target machine to make the dynamic
# linker aware of the new libraries

%post -p /sbin/ldconfig


# Run ldconfig after deinstall on the target machine of libraries

%postun -p /sbin/ldconfig


# rpmbuild gzip's image files below %{_infodir}, undo this after install of
# the documenttation on the target machine (the image files are for emacs'
# info mode and won't be recognized when gzip'ed). Then update the info
# dir file.

%post doc
gunzip %{_infodir}/xforms_images/*.png.gz
/sbin/install-info %{_infodir}/%{name}.info %{_infodir}/dir || :


# Remove the entry for the XForms info file from the dir file in %{_infdir}
# when uninstalling the documentation package on the target machine. 

%preun doc
if [ $1 = 0 ] ; then
  /sbin/install-info --delete %{_infodir}/%{name}.info %{_infodir}/dir || :
fi


%changelog
* Thu Jun 1 2010 Jens Thoms Toerring <jt@toerring.de> 1.0.93sp1
- New release 1.0.93sp1

* Wed Nov 4 2009 Jens Thoms Toerring <jt@toerring.de> 1.0.93sp1
- New release 1.0.91sp2

* Sat Nov 22 2008 Jens Thoms Toerring <jt@toerring.de> 1.0.91
- New release 1.0.91 - lots of bug fixes

* Wed Oct 6 2004 Angus Leeming <angus.leeming@btopenworld.com> 1.0.90
- Re-write the 'post' and 'postun' scripts to create the
  symbolic links correctly without requiring the SO_VERSION hack.

* Fri May 7 2004 Angus Leeming <angus.leeming@btopenworld.com> 1.0.90
- add code to the 'post' script to modify libforms.la et al. to prevent
  libtool from complaining that the files have been moved.

* Thu May 6 2004 Angus Leeming <angus.leeming@btopenworld.com> 1.0.90
- fix 'Release' and 'Source0' info.
- add 'post' and 'postun' scripts to create and remove symbolic links,
  respectively.

* Thu May 6 2004 Angus Leeming <angus.leeming@btopenworld.com> 1.0.90
- no longer place devfiles and binfiles in ${RPM_BUILD_ROOT}.
  Prevents rpm from bombing with a "Checking for unpackaged files" error.

* Sat Aug 31 2002 Duncan Haldane <duncan_haldane@users.sourceforge.net> 1.0-RC4
- mv fdesign, fd2ps to devel.  restore xforms name of rpm.

* Sun Jul 14 2002 Greg Hosler <hosler@lugs.org.sg> 1.0-RC4
- Pass DESTDIR to makeinstall_std.

* Thu Jul 11 2002 Peter Galbraith <balbraith@dfo-mpo.gc.ca> 1.0-RC4
- Move from libxforms to libforms to match other distros.

* Tue Jul 8 2002 Chris Freeze <cfreeze@alumni.clemson.edu> 1.0-RC4
- First stab at spec file.
